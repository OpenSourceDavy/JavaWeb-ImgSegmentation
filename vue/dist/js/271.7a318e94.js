"use strict";(self["webpackChunkcrm_vue"]=self["webpackChunkcrm_vue"]||[]).push([[271],{4271:function(e,t,l){l.r(t),l.d(t,{default:function(){return v}});var a=l(6252),i=l(3577),s=l(9963);const o={style:{padding:"10px"}},r={style:{margin:"10px 0px"}},d={class:"value"},m=(0,a.Uk)("查询"),u=(0,a.Uk)("上传"),n=(0,a.Uk)("查看"),h=(0,a.Uk)("下载"),p=(0,a.Uk)("编辑"),c=(0,a.Uk)("删除"),f={style:{margin:"10px 0px",float:"right"}},g=(0,a.Uk)("已评阅"),w=(0,a.Uk)("未评阅"),b=(0,a.Uk)("上传"),S={class:"dialog-footer"},y=(0,a.Uk)("取消"),W=(0,a.Uk)("确定");function V(e,t,l,V,k,_){const C=(0,a.up)("el-autocomplete"),U=(0,a.up)("el-button"),v=(0,a.up)("el-table-column"),N=(0,a.up)("el-image"),x=(0,a.up)("el-popconfirm"),z=(0,a.up)("el-table"),D=(0,a.up)("el-pagination"),P=(0,a.up)("el-input"),$=(0,a.up)("el-form-item"),F=(0,a.up)("el-option"),I=(0,a.up)("el-select"),J=(0,a.up)("el-radio"),O=(0,a.up)("el-upload"),X=(0,a.up)("el-form"),Z=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.iD)("div",o,[(0,a._)("div",r,[(0,a.Wm)(C,{modelValue:k.search,"onUpdate:modelValue":t[0]||(t[0]=e=>k.search=e),"fetch-suggestions":k.querySearch,placeholder:"请输入评阅状态",clearable:"",style:{width:"20%","margin-left":"950px"}},{default:(0,a.w5)((({item:e})=>[(0,a._)("div",d,(0,i.zw)(e.value),1)])),_:1},8,["modelValue","fetch-suggestions"]),(0,a.Wm)(U,{type:"primary",style:{"margin-left":"5px"},onClick:_.load},{default:(0,a.w5)((()=>[m])),_:1},8,["onClick"]),(0,a.wy)((0,a.Wm)(U,{type:"primary",style:{"margin-left":"5px"},onClick:_.upload},{default:(0,a.w5)((()=>[u])),_:1},8,["onClick"]),[[s.F8,k.isShow]])]),(0,a.Wm)(z,{data:k.tableData,border:"",style:{width:"100%"},stripe:""},{default:(0,a.w5)((()=>[(0,a.Wm)(v,{prop:"id",label:"X光图ID",sortable:""}),(0,a.Wm)(v,{prop:"PName",label:"病人姓名"}),(0,a.Wm)(v,{prop:"SName",label:"专家姓名"}),(0,a.Wm)(v,{label:"X光图"},{default:(0,a.w5)((e=>[(0,a.Wm)(N,{style:{width:"100px",height:"100px"},src:e.row.img,"preview-src-list":[e.row.img],fit:"cover","preview-teleported":"true"},null,8,["src","preview-src-list"])])),_:1}),(0,a.Wm)(v,{label:"专家评阅结果"},{default:(0,a.w5)((e=>[(0,a.Wm)(U,{size:"mini",onClick:t=>_.check(e.row)},{default:(0,a.w5)((()=>[n])),_:2},1032,["onClick"]),(0,a.Wm)(U,{size:"mini",onClick:t=>_.downLoad(e.row)},{default:(0,a.w5)((()=>[h])),_:2},1032,["onClick"])])),_:1}),(0,a.Wm)(v,{prop:"state",label:"评阅状态",sortable:""}),(0,a.Wm)(v,{prop:"createTime",label:"上传时间",sortable:""}),(0,a.Wm)(v,{label:"操作"},{default:(0,a.w5)((e=>[(0,a.Wm)(U,{size:"mini",onClick:t=>_.handleEidt(e.row)},{default:(0,a.w5)((()=>[p])),_:2},1032,["onClick"]),(0,a.Wm)(x,{title:"你确认删除吗?",onConfirm:t=>_.handleDelete(e.row.id)},{reference:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(U,{size:"mini",type:"danger"},{default:(0,a.w5)((()=>[c])),_:1},512),[[s.F8,!k.isS]])])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data"]),(0,a._)("div",f,[(0,a.Wm)(D,{currentPage:k.currentPage,"onUpdate:currentPage":t[1]||(t[1]=e=>k.currentPage=e),"page-size":k.pageSize,"page-sizes":[5,10,20],layout:"total, sizes, prev, pager, next, jumper",total:k.total,onSizeChange:_.handleSizeChange,onCurrentChange:_.handleCurrentChange},null,8,["currentPage","page-size","total","onSizeChange","onCurrentChange"]),(0,a.Wm)(Z,{modelValue:k.dialogVisible,"onUpdate:modelValue":t[9]||(t[9]=e=>k.dialogVisible=e),title:"上传或更新",width:"30%"},{footer:(0,a.w5)((()=>[(0,a._)("span",S,[(0,a.Wm)(U,{onClick:t[8]||(t[8]=e=>k.dialogVisible=!1)},{default:(0,a.w5)((()=>[y])),_:1}),(0,a.Wm)(U,{type:"primary",onClick:_.save},{default:(0,a.w5)((()=>[W])),_:1},8,["onClick"])])])),default:(0,a.w5)((()=>[(0,a.Wm)(X,{model:k.form,"label-width":"120px"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)($,{label:"X光图ID"},{default:(0,a.w5)((()=>[(0,a.Wm)(P,{modelValue:k.form.id,"onUpdate:modelValue":t[2]||(t[2]=e=>k.form.id=e),style:{width:"160px"},disabled:""},null,8,["modelValue"])])),_:1},512),[[s.F8,k.isNotShow]]),(0,a.wy)((0,a.Wm)($,{label:"病人ID"},{default:(0,a.w5)((()=>[(0,a.Wm)(P,{modelValue:k.form.pid,"onUpdate:modelValue":t[3]||(t[3]=e=>k.form.pid=e),style:{width:"160px"},disabled:""},null,8,["modelValue"])])),_:1},512),[[s.F8,k.isNotShow]]),(0,a.Wm)($,{label:"请选择专家"},{default:(0,a.w5)((()=>[(0,a.Wm)(I,{modelValue:k.form.SName,"onUpdate:modelValue":t[4]||(t[4]=e=>k.form.SName=e),clearable:"",onChange:_.changeS,size:"small"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(k.specialist,(e=>((0,a.wg)(),(0,a.j4)(F,{key:e.id,label:e.nickName,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1}),(0,a.wy)((0,a.Wm)($,{label:"专家评阅结果"},{default:(0,a.w5)((()=>[(0,a.Wm)(P,{modelValue:k.form.result,"onUpdate:modelValue":t[5]||(t[5]=e=>k.form.result=e),style:{width:"160px"},disabled:""},null,8,["modelValue"])])),_:1},512),[[s.F8,k.isNotShow]]),(0,a.wy)((0,a.Wm)($,{label:"评阅状态"},{default:(0,a.w5)((()=>[(0,a.Wm)(J,{modelValue:k.form.state,"onUpdate:modelValue":t[6]||(t[6]=e=>k.form.state=e),label:"已评阅"},{default:(0,a.w5)((()=>[g])),_:1},8,["modelValue"]),(0,a.Wm)(J,{modelValue:k.form.state,"onUpdate:modelValue":t[7]||(t[7]=e=>k.form.state=e),label:"未评阅"},{default:(0,a.w5)((()=>[w])),_:1},8,["modelValue"])])),_:1},512),[[s.F8,k.isNotShow]]),(0,a.Wm)($,{label:"X光图",style:{width:"300px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(O,{ref:"upload",action:k.filesUploadUrl,"on-success":_.fileUpload,style:{width:"300px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(U,{type:"primary"},{default:(0,a.w5)((()=>[b])),_:1})])),_:1},8,["action","on-success"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,a.Wm)(Z,{modelValue:k.isShowResult,"onUpdate:modelValue":t[11]||(t[11]=e=>k.isShowResult=e),title:"专家评阅结果",width:"50%"},{default:(0,a.w5)((()=>[(0,a.Wm)(P,{type:"textarea",rows:20,placeholder:"请输入内容",modelValue:k.result,"onUpdate:modelValue":t[10]||(t[10]=e=>k.result=e),disabled:""},null,8,["modelValue"])])),_:1},8,["modelValue"])])])}var k=l(4471),_={name:"Img",components:{},data(){return{querySearch:[{value:"已评阅"},{value:"未评阅"}],search:"",currentPage:1,pageSize:10,total:1,tableData:[],form:{},dialogVisible:!1,isShowResult:!1,user:{},isShow:!1,isNotShow:!0,specialist:[],patient:[],result:"",isS:!1,isP:!1,isA:!1,filesUploadUrl:"http://"+window.server.filesUploadUrl+":9090/files/upload"}},created(){let e=sessionStorage.getItem("user")||"{}";this.user=JSON.parse(e);let t=sessionStorage.getItem("specialist")||"{}";this.specialist=JSON.parse(t);let l=sessionStorage.getItem("patient")||"{}";this.patient=JSON.parse(l),"0"===this.user.role?(this.isA=!0,this.isS=!1,this.isP=!1):"1"===this.user.role?(this.isShow=!0,this.isNotShow=!1,this.isA=!1,this.isS=!1,this.isP=!0):(this.isA=!1,this.isS=!0,this.isP=!1),this.load()},methods:{load(){this.tableData=[];let e="",t="";"0"===this.user.role?(e="",t=""):"1"===this.user.role?(e="",t=this.user.id):"2"===this.user.role&&(e=this.user.id,t=""),k.Z.get("/img",{params:{pageNum:this.currentPage,pageSize:this.pageSize,search:this.search,sid:e,pid:t}}).then((e=>{this.tableData=e.data.records,this.total=e.data.total,this.tableData.forEach((e=>{this.specialist.forEach((t=>{e.sid==t.id&&(e.SName=t.nickName)})),this.patient.forEach((t=>{e.pid==t.id&&(e.PName=t.nickName)}))}))}))},fileUpload(e){this.form.img=e.data},save(){this.form.id?k.Z.put("/img",this.form).then((e=>{"0"===e.code?this.$message({type:"success",message:"更新成功"}):this.$message({type:"error",message:e.message}),this.load(),this.dialogVisible=!1})):k.Z.post("/img",this.form).then((e=>{"0"===e.code?this.$message({type:"success",message:"新增成功"}):this.$message({type:"error",message:e.message}),this.load(),this.dialogVisible=!1}))},handleSizeChange(e){this.pageSize=e,this.load()},handleCurrentChange(e){this.currentPage=e,this.load()},upload(){""!=this.tableData&&(this.form=this.tableData[0],this.form.id=""),this.form.pid=this.user.id,this.form.state="未评阅",this.form.result="",this.dialogVisible=!0,this.$refs["upload"].clearFiles()},changeS(e){this.form.sid=e},check(e){this.isShowResult=!0,this.result=e.result},downLoad(e){if("未评阅"==e.state)return this.$alert("该脊椎X光图专家还未评阅，请耐心等待，谢谢","提示",{confirmButtonText:"确定",type:"warning"}),!1;if(""==e.result)return this.$alert("该脊椎X光图专家还未曾给出建议，请耐心等待，谢谢","提示",{confirmButtonText:"确定",type:"warning"}),!1;this.form=JSON.parse(JSON.stringify(e));let t="";k.Z.post("/files/integration",this.form).then((e=>{t=e.data;let l="http://175.24.204.121:9090/files/"+t;window.open(l)}))},handleEidt(e){this.form=JSON.parse(JSON.stringify(e)),"0"===this.user.role||"1"===this.user.role?(this.$nextTick((()=>{this.$refs["upload"].clearFiles()})),this.dialogVisible=!0):"2"===this.user.role&&(sessionStorage.setItem("img",JSON.stringify(e)),this.$router.push("/canvas"))},handleDelete(e){k.Z["delete"]("/img/"+e).then((e=>{"0"===e.code?this.$message({type:"success",message:"删除成功"}):this.$message({type:"error",message:e.message}),this.load()}))}}},C=l(3744);const U=(0,C.Z)(_,[["render",V]]);var v=U}}]);
//# sourceMappingURL=271.7a318e94.js.map