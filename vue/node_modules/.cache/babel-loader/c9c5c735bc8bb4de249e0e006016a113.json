{"ast":null,"code":"import { ref, getCurrentInstance, watch, nextTick } from 'vue';\nimport { SetOperationEnum, NODE_CHECK, NODE_CHECK_CHANGE } from '../virtual-tree.mjs';\n\nfunction useCheck(props, tree) {\n  const checkedKeys = ref( /* @__PURE__ */new Set());\n  const indeterminateKeys = ref( /* @__PURE__ */new Set());\n  const {\n    emit\n  } = getCurrentInstance();\n  watch(() => tree.value, () => {\n    return nextTick(() => {\n      _setCheckedKeys(props.defaultCheckedKeys);\n    });\n  }, {\n    immediate: true\n  });\n\n  const updateCheckedKeys = () => {\n    if (!tree.value || !props.showCheckbox || props.checkStrictly) {\n      return;\n    }\n\n    const {\n      levelTreeNodeMap,\n      maxLevel\n    } = tree.value;\n    const checkedKeySet = checkedKeys.value;\n    const indeterminateKeySet = /* @__PURE__ */new Set();\n\n    for (let level = maxLevel - 1; level >= 1; --level) {\n      const nodes = levelTreeNodeMap.get(level);\n      if (!nodes) continue;\n      nodes.forEach(node => {\n        const children = node.children;\n\n        if (children) {\n          let allChecked = true;\n          let hasChecked = false;\n\n          for (const childNode of children) {\n            const key = childNode.key;\n\n            if (checkedKeySet.has(key)) {\n              hasChecked = true;\n            } else if (indeterminateKeySet.has(key)) {\n              allChecked = false;\n              hasChecked = true;\n              break;\n            } else {\n              allChecked = false;\n            }\n          }\n\n          if (allChecked) {\n            checkedKeySet.add(node.key);\n          } else if (hasChecked) {\n            indeterminateKeySet.add(node.key);\n            checkedKeySet.delete(node.key);\n          } else {\n            checkedKeySet.delete(node.key);\n            indeterminateKeySet.delete(node.key);\n          }\n        }\n      });\n    }\n\n    indeterminateKeys.value = indeterminateKeySet;\n  };\n\n  const isChecked = node => checkedKeys.value.has(node.key);\n\n  const isIndeterminate = node => indeterminateKeys.value.has(node.key);\n\n  const toggleCheckbox = (node, isChecked2, nodeClick = true) => {\n    const checkedKeySet = checkedKeys.value;\n\n    const toggle = (node2, checked) => {\n      checkedKeySet[checked ? SetOperationEnum.ADD : SetOperationEnum.DELETE](node2.key);\n      const children = node2.children;\n\n      if (!props.checkStrictly && children) {\n        children.forEach(childNode => {\n          if (!childNode.disabled) {\n            toggle(childNode, checked);\n          }\n        });\n      }\n    };\n\n    toggle(node, isChecked2);\n    updateCheckedKeys();\n\n    if (nodeClick) {\n      afterNodeCheck(node, isChecked2);\n    }\n  };\n\n  const afterNodeCheck = (node, checked) => {\n    const {\n      checkedNodes,\n      checkedKeys: checkedKeys2\n    } = getChecked();\n    const {\n      halfCheckedNodes,\n      halfCheckedKeys\n    } = getHalfChecked();\n    emit(NODE_CHECK, node.data, {\n      checkedKeys: checkedKeys2,\n      checkedNodes,\n      halfCheckedKeys,\n      halfCheckedNodes\n    });\n    emit(NODE_CHECK_CHANGE, node.data, checked);\n  };\n\n  function getCheckedKeys(leafOnly = false) {\n    return getChecked(leafOnly).checkedKeys;\n  }\n\n  function getCheckedNodes(leafOnly = false) {\n    return getChecked(leafOnly).checkedNodes;\n  }\n\n  function getHalfCheckedKeys() {\n    return getHalfChecked().halfCheckedKeys;\n  }\n\n  function getHalfCheckedNodes() {\n    return getHalfChecked().halfCheckedNodes;\n  }\n\n  function getChecked(leafOnly = false) {\n    const checkedNodes = [];\n    const keys = [];\n\n    if ((tree == null ? void 0 : tree.value) && props.showCheckbox) {\n      const {\n        treeNodeMap\n      } = tree.value;\n      checkedKeys.value.forEach(key => {\n        const node = treeNodeMap.get(key);\n\n        if (node && (!leafOnly || leafOnly && node.isLeaf)) {\n          keys.push(key);\n          checkedNodes.push(node.data);\n        }\n      });\n    }\n\n    return {\n      checkedKeys: keys,\n      checkedNodes\n    };\n  }\n\n  function getHalfChecked() {\n    const halfCheckedNodes = [];\n    const halfCheckedKeys = [];\n\n    if ((tree == null ? void 0 : tree.value) && props.showCheckbox) {\n      const {\n        treeNodeMap\n      } = tree.value;\n      indeterminateKeys.value.forEach(key => {\n        const node = treeNodeMap.get(key);\n\n        if (node) {\n          halfCheckedKeys.push(key);\n          halfCheckedNodes.push(node.data);\n        }\n      });\n    }\n\n    return {\n      halfCheckedNodes,\n      halfCheckedKeys\n    };\n  }\n\n  function setCheckedKeys(keys) {\n    checkedKeys.value.clear();\n    indeterminateKeys.value.clear();\n\n    _setCheckedKeys(keys);\n  }\n\n  function setChecked(key, isChecked2) {\n    if ((tree == null ? void 0 : tree.value) && props.showCheckbox) {\n      const node = tree.value.treeNodeMap.get(key);\n\n      if (node) {\n        toggleCheckbox(node, isChecked2, false);\n      }\n    }\n  }\n\n  function _setCheckedKeys(keys) {\n    if (tree == null ? void 0 : tree.value) {\n      const {\n        treeNodeMap\n      } = tree.value;\n\n      if (props.showCheckbox && treeNodeMap && keys) {\n        for (const key of keys) {\n          const node = treeNodeMap.get(key);\n\n          if (node && !isChecked(node)) {\n            toggleCheckbox(node, true, false);\n          }\n        }\n      }\n    }\n  }\n\n  return {\n    updateCheckedKeys,\n    toggleCheckbox,\n    isChecked,\n    isIndeterminate,\n    getCheckedKeys,\n    getCheckedNodes,\n    getHalfCheckedKeys,\n    getHalfCheckedNodes,\n    setChecked,\n    setCheckedKeys\n  };\n}\n\nexport { useCheck };","map":{"version":3,"mappings":"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","names":["useCheck","props","tree","checkedKeys","ref","Set","indeterminateKeys","emit","getCurrentInstance","watch","value","nextTick","_setCheckedKeys","defaultCheckedKeys","immediate","updateCheckedKeys","showCheckbox","checkStrictly","levelTreeNodeMap","maxLevel","checkedKeySet","indeterminateKeySet","level","nodes","get","forEach","node","children","allChecked","hasChecked","childNode","key","has","add","delete","isChecked","isIndeterminate","toggleCheckbox","isChecked2","nodeClick","toggle","node2","checked","SetOperationEnum","ADD","DELETE","disabled","afterNodeCheck","checkedNodes","checkedKeys2","getChecked","halfCheckedNodes","halfCheckedKeys","getHalfChecked","NODE_CHECK","data","NODE_CHECK_CHANGE","getCheckedKeys","leafOnly","getCheckedNodes","getHalfCheckedKeys","getHalfCheckedNodes","keys","treeNodeMap","isLeaf","push","setCheckedKeys","clear","setChecked"],"sources":["../../../../../../../packages/components/tree-v2/src/composables/useCheck.ts"],"sourcesContent":["import { getCurrentInstance, nextTick, ref, watch } from 'vue'\nimport {\n  NODE_CHECK,\n  NODE_CHECK_CHANGE,\n  SetOperationEnum,\n} from '../virtual-tree'\nimport type { Ref } from 'vue'\nimport type { Tree, TreeKey, TreeNode, TreeNodeData, TreeProps } from '../types'\n\nexport function useCheck(props: TreeProps, tree: Ref<Tree | undefined>) {\n  const checkedKeys = ref<Set<TreeKey>>(new Set())\n  const indeterminateKeys = ref<Set<TreeKey>>(new Set())\n  const { emit } = getCurrentInstance()!\n\n  watch(\n    () => tree.value,\n    () => {\n      return nextTick(() => {\n        _setCheckedKeys(props.defaultCheckedKeys)\n      })\n    },\n    {\n      immediate: true,\n    }\n  )\n\n  const updateCheckedKeys = () => {\n    if (!tree.value || !props.showCheckbox || props.checkStrictly) {\n      return\n    }\n    const { levelTreeNodeMap, maxLevel } = tree.value\n    const checkedKeySet = checkedKeys.value\n    const indeterminateKeySet = new Set<TreeKey>()\n    // It is easier to determine the indeterminate state by\n    // traversing from bottom to top\n    // leaf nodes not have indeterminate status and can be skipped\n    for (let level = maxLevel - 1; level >= 1; --level) {\n      const nodes = levelTreeNodeMap.get(level)\n      if (!nodes) continue\n      nodes.forEach((node) => {\n        const children = node.children\n        if (children) {\n          // Whether all child nodes are selected\n          let allChecked = true\n          // Whether a child node is selected\n          let hasChecked = false\n          for (const childNode of children) {\n            const key = childNode.key\n            if (checkedKeySet.has(key)) {\n              hasChecked = true\n            } else if (indeterminateKeySet.has(key)) {\n              allChecked = false\n              hasChecked = true\n              break\n            } else {\n              allChecked = false\n            }\n          }\n          if (allChecked) {\n            checkedKeySet.add(node.key)\n          } else if (hasChecked) {\n            indeterminateKeySet.add(node.key)\n            checkedKeySet.delete(node.key)\n          } else {\n            checkedKeySet.delete(node.key)\n            indeterminateKeySet.delete(node.key)\n          }\n        }\n      })\n    }\n    indeterminateKeys.value = indeterminateKeySet\n  }\n\n  const isChecked = (node: TreeNode) => checkedKeys.value.has(node.key)\n\n  const isIndeterminate = (node: TreeNode) =>\n    indeterminateKeys.value.has(node.key)\n\n  const toggleCheckbox = (\n    node: TreeNode,\n    isChecked: boolean,\n    nodeClick = true\n  ) => {\n    const checkedKeySet = checkedKeys.value\n    const toggle = (node: TreeNode, checked: boolean) => {\n      checkedKeySet[checked ? SetOperationEnum.ADD : SetOperationEnum.DELETE](\n        node.key\n      )\n      const children = node.children\n      if (!props.checkStrictly && children) {\n        children.forEach((childNode) => {\n          if (!childNode.disabled) {\n            toggle(childNode, checked)\n          }\n        })\n      }\n    }\n    toggle(node, isChecked)\n    updateCheckedKeys()\n    if (nodeClick) {\n      afterNodeCheck(node, isChecked)\n    }\n  }\n\n  const afterNodeCheck = (node: TreeNode, checked: boolean) => {\n    const { checkedNodes, checkedKeys } = getChecked()\n    const { halfCheckedNodes, halfCheckedKeys } = getHalfChecked()\n    emit(NODE_CHECK, node.data, {\n      checkedKeys,\n      checkedNodes,\n      halfCheckedKeys,\n      halfCheckedNodes,\n    })\n    emit(NODE_CHECK_CHANGE, node.data, checked)\n  }\n\n  // expose\n  function getCheckedKeys(leafOnly = false): TreeKey[] {\n    return getChecked(leafOnly).checkedKeys\n  }\n\n  function getCheckedNodes(leafOnly = false): TreeNodeData[] {\n    return getChecked(leafOnly).checkedNodes\n  }\n\n  function getHalfCheckedKeys(): TreeKey[] {\n    return getHalfChecked().halfCheckedKeys\n  }\n\n  function getHalfCheckedNodes(): TreeNodeData[] {\n    return getHalfChecked().halfCheckedNodes\n  }\n\n  function getChecked(leafOnly = false): {\n    checkedKeys: TreeKey[]\n    checkedNodes: TreeNodeData[]\n  } {\n    const checkedNodes: TreeNodeData[] = []\n    const keys: TreeKey[] = []\n    if (tree?.value && props.showCheckbox) {\n      const { treeNodeMap } = tree.value\n      checkedKeys.value.forEach((key) => {\n        const node = treeNodeMap.get(key)\n        if (node && (!leafOnly || (leafOnly && node.isLeaf))) {\n          keys.push(key)\n          checkedNodes.push(node.data)\n        }\n      })\n    }\n    return {\n      checkedKeys: keys,\n      checkedNodes,\n    }\n  }\n\n  function getHalfChecked(): {\n    halfCheckedKeys: TreeKey[]\n    halfCheckedNodes: TreeNodeData[]\n  } {\n    const halfCheckedNodes: TreeNodeData[] = []\n    const halfCheckedKeys: TreeKey[] = []\n    if (tree?.value && props.showCheckbox) {\n      const { treeNodeMap } = tree.value\n      indeterminateKeys.value.forEach((key) => {\n        const node = treeNodeMap.get(key)\n        if (node) {\n          halfCheckedKeys.push(key)\n          halfCheckedNodes.push(node.data)\n        }\n      })\n    }\n    return {\n      halfCheckedNodes,\n      halfCheckedKeys,\n    }\n  }\n\n  function setCheckedKeys(keys: TreeKey[]) {\n    checkedKeys.value.clear()\n    indeterminateKeys.value.clear()\n    _setCheckedKeys(keys)\n  }\n\n  function setChecked(key: TreeKey, isChecked: boolean) {\n    if (tree?.value && props.showCheckbox) {\n      const node = tree.value.treeNodeMap.get(key)\n      if (node) {\n        toggleCheckbox(node, isChecked, false)\n      }\n    }\n  }\n\n  function _setCheckedKeys(keys: TreeKey[]) {\n    if (tree?.value) {\n      const { treeNodeMap } = tree.value\n      if (props.showCheckbox && treeNodeMap && keys) {\n        for (const key of keys) {\n          const node = treeNodeMap.get(key)\n          if (node && !isChecked(node)) {\n            toggleCheckbox(node, true, false)\n          }\n        }\n      }\n    }\n  }\n\n  return {\n    updateCheckedKeys,\n    toggleCheckbox,\n    isChecked,\n    isIndeterminate,\n    // expose\n    getCheckedKeys,\n    getCheckedNodes,\n    getHalfCheckedKeys,\n    getHalfCheckedNodes,\n    setChecked,\n    setCheckedKeys,\n  }\n}\n"]},"metadata":{},"sourceType":"module"}