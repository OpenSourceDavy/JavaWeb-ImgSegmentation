{"ast":null,"code":"import { defineComponent, inject, ref, getCurrentInstance, provide, watch, nextTick, resolveComponent, withDirectives, openBlock, createElementBlock, normalizeClass, withModifiers, createElementVNode, normalizeStyle, createBlock, withCtx, resolveDynamicComponent, createCommentVNode, createVNode, Fragment, renderList, vShow } from 'vue';\nimport { isFunction, isString } from '@vue/shared';\nimport _CollapseTransition from '../../collapse-transition/index.mjs';\nimport { ElCheckbox } from '../../checkbox/index.mjs';\nimport { ElIcon } from '../../icon/index.mjs';\nimport { Loading, CaretRight } from '@element-plus/icons-vue';\nimport '../../../utils/index.mjs';\nimport '../../../hooks/index.mjs';\nimport NodeContent from './tree-node-content.mjs';\nimport { getNodeKey } from './model/util.mjs';\nimport { useNodeExpandEventBroadcast } from './model/useNodeExpandEventBroadcast.mjs';\nimport { dragEventsKey } from './model/useDragNode.mjs';\nimport Node from './model/node.mjs';\nimport _export_sfc from '../../../_virtual/plugin-vue_export-helper.mjs';\nimport { useNamespace } from '../../../hooks/use-namespace/index.mjs';\nimport { debugWarn } from '../../../utils/error.mjs';\n\nconst _sfc_main = defineComponent({\n  name: \"ElTreeNode\",\n  components: {\n    ElCollapseTransition: _CollapseTransition,\n    ElCheckbox,\n    NodeContent,\n    ElIcon,\n    Loading\n  },\n  props: {\n    node: {\n      type: Node,\n      default: () => ({})\n    },\n    props: {\n      type: Object,\n      default: () => ({})\n    },\n    accordion: Boolean,\n    renderContent: Function,\n    renderAfterExpand: Boolean,\n    showCheckbox: {\n      type: Boolean,\n      default: false\n    }\n  },\n  emits: [\"node-expand\"],\n\n  setup(props, ctx) {\n    const ns = useNamespace(\"tree\");\n    const {\n      broadcastExpanded\n    } = useNodeExpandEventBroadcast(props);\n    const tree = inject(\"RootTree\");\n    const expanded = ref(false);\n    const childNodeRendered = ref(false);\n    const oldChecked = ref(null);\n    const oldIndeterminate = ref(null);\n    const node$ = ref(null);\n    const dragEvents = inject(dragEventsKey);\n    const instance = getCurrentInstance();\n    provide(\"NodeInstance\", instance);\n\n    if (!tree) {\n      debugWarn(\"Tree\", \"Can not find node's tree.\");\n    }\n\n    if (props.node.expanded) {\n      expanded.value = true;\n      childNodeRendered.value = true;\n    }\n\n    const childrenKey = tree.props[\"children\"] || \"children\";\n    watch(() => {\n      const children = props.node.data[childrenKey];\n      return children && [...children];\n    }, () => {\n      props.node.updateChildren();\n    });\n    watch(() => props.node.indeterminate, val => {\n      handleSelectChange(props.node.checked, val);\n    });\n    watch(() => props.node.checked, val => {\n      handleSelectChange(val, props.node.indeterminate);\n    });\n    watch(() => props.node.expanded, val => {\n      nextTick(() => expanded.value = val);\n\n      if (val) {\n        childNodeRendered.value = true;\n      }\n    });\n\n    const getNodeKey$1 = node => {\n      return getNodeKey(tree.props.nodeKey, node.data);\n    };\n\n    const getNodeClass = node => {\n      const nodeClassFunc = props.props.class;\n\n      if (!nodeClassFunc) {\n        return {};\n      }\n\n      let className;\n\n      if (isFunction(nodeClassFunc)) {\n        const {\n          data\n        } = node;\n        className = nodeClassFunc(data, node);\n      } else {\n        className = nodeClassFunc;\n      }\n\n      if (isString(className)) {\n        return {\n          [className]: true\n        };\n      } else {\n        return className;\n      }\n    };\n\n    const handleSelectChange = (checked, indeterminate) => {\n      if (oldChecked.value !== checked || oldIndeterminate.value !== indeterminate) {\n        tree.ctx.emit(\"check-change\", props.node.data, checked, indeterminate);\n      }\n\n      oldChecked.value = checked;\n      oldIndeterminate.value = indeterminate;\n    };\n\n    const handleClick = e => {\n      const store = tree.store.value;\n      store.setCurrentNode(props.node);\n      tree.ctx.emit(\"current-change\", store.currentNode ? store.currentNode.data : null, store.currentNode);\n      tree.currentNode.value = props.node;\n\n      if (tree.props.expandOnClickNode) {\n        handleExpandIconClick();\n      }\n\n      if (tree.props.checkOnClickNode && !props.node.disabled) {\n        handleCheckChange(null, {\n          target: {\n            checked: !props.node.checked\n          }\n        });\n      }\n\n      tree.ctx.emit(\"node-click\", props.node.data, props.node, instance, e);\n    };\n\n    const handleContextMenu = event => {\n      if (tree.instance.vnode.props[\"onNodeContextmenu\"]) {\n        event.stopPropagation();\n        event.preventDefault();\n      }\n\n      tree.ctx.emit(\"node-contextmenu\", event, props.node.data, props.node, instance);\n    };\n\n    const handleExpandIconClick = () => {\n      if (props.node.isLeaf) return;\n\n      if (expanded.value) {\n        tree.ctx.emit(\"node-collapse\", props.node.data, props.node, instance);\n        props.node.collapse();\n      } else {\n        props.node.expand();\n        ctx.emit(\"node-expand\", props.node.data, props.node, instance);\n      }\n    };\n\n    const handleCheckChange = (value, ev) => {\n      props.node.setChecked(ev.target.checked, !tree.props.checkStrictly);\n      nextTick(() => {\n        const store = tree.store.value;\n        tree.ctx.emit(\"check\", props.node.data, {\n          checkedNodes: store.getCheckedNodes(),\n          checkedKeys: store.getCheckedKeys(),\n          halfCheckedNodes: store.getHalfCheckedNodes(),\n          halfCheckedKeys: store.getHalfCheckedKeys()\n        });\n      });\n    };\n\n    const handleChildNodeExpand = (nodeData, node, instance2) => {\n      broadcastExpanded(node);\n      tree.ctx.emit(\"node-expand\", nodeData, node, instance2);\n    };\n\n    const handleDragStart = event => {\n      if (!tree.props.draggable) return;\n      dragEvents.treeNodeDragStart({\n        event,\n        treeNode: props\n      });\n    };\n\n    const handleDragOver = event => {\n      event.preventDefault();\n      if (!tree.props.draggable) return;\n      dragEvents.treeNodeDragOver({\n        event,\n        treeNode: {\n          $el: node$.value,\n          node: props.node\n        }\n      });\n    };\n\n    const handleDrop = event => {\n      event.preventDefault();\n    };\n\n    const handleDragEnd = event => {\n      if (!tree.props.draggable) return;\n      dragEvents.treeNodeDragEnd(event);\n    };\n\n    return {\n      ns,\n      node$,\n      tree,\n      expanded,\n      childNodeRendered,\n      oldChecked,\n      oldIndeterminate,\n      getNodeKey: getNodeKey$1,\n      getNodeClass,\n      handleSelectChange,\n      handleClick,\n      handleContextMenu,\n      handleExpandIconClick,\n      handleCheckChange,\n      handleChildNodeExpand,\n      handleDragStart,\n      handleDragOver,\n      handleDrop,\n      handleDragEnd,\n      CaretRight\n    };\n  }\n\n});\n\nconst _hoisted_1 = [\"aria-expanded\", \"aria-disabled\", \"aria-checked\", \"draggable\", \"data-key\"];\nconst _hoisted_2 = [\"aria-expanded\"];\n\nfunction _sfc_render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_icon = resolveComponent(\"el-icon\");\n\n  const _component_el_checkbox = resolveComponent(\"el-checkbox\");\n\n  const _component_loading = resolveComponent(\"loading\");\n\n  const _component_node_content = resolveComponent(\"node-content\");\n\n  const _component_el_tree_node = resolveComponent(\"el-tree-node\");\n\n  const _component_el_collapse_transition = resolveComponent(\"el-collapse-transition\");\n\n  return withDirectives((openBlock(), createElementBlock(\"div\", {\n    ref: \"node$\",\n    class: normalizeClass([_ctx.ns.b(\"node\"), _ctx.ns.is(\"expanded\", _ctx.expanded), _ctx.ns.is(\"current\", _ctx.node.isCurrent), _ctx.ns.is(\"hidden\", !_ctx.node.visible), _ctx.ns.is(\"focusable\", !_ctx.node.disabled), _ctx.ns.is(\"checked\", !_ctx.node.disabled && _ctx.node.checked), _ctx.getNodeClass(_ctx.node)]),\n    role: \"treeitem\",\n    tabindex: \"-1\",\n    \"aria-expanded\": _ctx.expanded,\n    \"aria-disabled\": _ctx.node.disabled,\n    \"aria-checked\": _ctx.node.checked,\n    draggable: _ctx.tree.props.draggable,\n    \"data-key\": _ctx.getNodeKey(_ctx.node),\n    onClick: _cache[1] || (_cache[1] = withModifiers((...args) => _ctx.handleClick && _ctx.handleClick(...args), [\"stop\"])),\n    onContextmenu: _cache[2] || (_cache[2] = (...args) => _ctx.handleContextMenu && _ctx.handleContextMenu(...args)),\n    onDragstart: _cache[3] || (_cache[3] = withModifiers((...args) => _ctx.handleDragStart && _ctx.handleDragStart(...args), [\"stop\"])),\n    onDragover: _cache[4] || (_cache[4] = withModifiers((...args) => _ctx.handleDragOver && _ctx.handleDragOver(...args), [\"stop\"])),\n    onDragend: _cache[5] || (_cache[5] = withModifiers((...args) => _ctx.handleDragEnd && _ctx.handleDragEnd(...args), [\"stop\"])),\n    onDrop: _cache[6] || (_cache[6] = withModifiers((...args) => _ctx.handleDrop && _ctx.handleDrop(...args), [\"stop\"]))\n  }, [createElementVNode(\"div\", {\n    class: normalizeClass(_ctx.ns.be(\"node\", \"content\")),\n    style: normalizeStyle({\n      paddingLeft: (_ctx.node.level - 1) * _ctx.tree.props.indent + \"px\"\n    })\n  }, [_ctx.tree.props.icon || _ctx.CaretRight ? (openBlock(), createBlock(_component_el_icon, {\n    key: 0,\n    class: normalizeClass([_ctx.ns.be(\"node\", \"expand-icon\"), _ctx.ns.is(\"leaf\", _ctx.node.isLeaf), {\n      expanded: !_ctx.node.isLeaf && _ctx.expanded\n    }]),\n    onClick: withModifiers(_ctx.handleExpandIconClick, [\"stop\"])\n  }, {\n    default: withCtx(() => [(openBlock(), createBlock(resolveDynamicComponent(_ctx.tree.props.icon || _ctx.CaretRight)))]),\n    _: 1\n  }, 8, [\"class\", \"onClick\"])) : createCommentVNode(\"v-if\", true), _ctx.showCheckbox ? (openBlock(), createBlock(_component_el_checkbox, {\n    key: 1,\n    \"model-value\": _ctx.node.checked,\n    indeterminate: _ctx.node.indeterminate,\n    disabled: !!_ctx.node.disabled,\n    onClick: _cache[0] || (_cache[0] = withModifiers(() => {}, [\"stop\"])),\n    onChange: _ctx.handleCheckChange\n  }, null, 8, [\"model-value\", \"indeterminate\", \"disabled\", \"onChange\"])) : createCommentVNode(\"v-if\", true), _ctx.node.loading ? (openBlock(), createBlock(_component_el_icon, {\n    key: 2,\n    class: normalizeClass([_ctx.ns.be(\"node\", \"loading-icon\"), _ctx.ns.is(\"loading\")])\n  }, {\n    default: withCtx(() => [createVNode(_component_loading)]),\n    _: 1\n  }, 8, [\"class\"])) : createCommentVNode(\"v-if\", true), createVNode(_component_node_content, {\n    node: _ctx.node,\n    \"render-content\": _ctx.renderContent\n  }, null, 8, [\"node\", \"render-content\"])], 6), createVNode(_component_el_collapse_transition, null, {\n    default: withCtx(() => [!_ctx.renderAfterExpand || _ctx.childNodeRendered ? withDirectives((openBlock(), createElementBlock(\"div\", {\n      key: 0,\n      class: normalizeClass(_ctx.ns.be(\"node\", \"children\")),\n      role: \"group\",\n      \"aria-expanded\": _ctx.expanded\n    }, [(openBlock(true), createElementBlock(Fragment, null, renderList(_ctx.node.childNodes, child => {\n      return openBlock(), createBlock(_component_el_tree_node, {\n        key: _ctx.getNodeKey(child),\n        \"render-content\": _ctx.renderContent,\n        \"render-after-expand\": _ctx.renderAfterExpand,\n        \"show-checkbox\": _ctx.showCheckbox,\n        node: child,\n        accordion: _ctx.accordion,\n        props: _ctx.props,\n        onNodeExpand: _ctx.handleChildNodeExpand\n      }, null, 8, [\"render-content\", \"render-after-expand\", \"show-checkbox\", \"node\", \"accordion\", \"props\", \"onNodeExpand\"]);\n    }), 128))], 10, _hoisted_2)), [[vShow, _ctx.expanded]]) : createCommentVNode(\"v-if\", true)]),\n    _: 1\n  })], 42, _hoisted_1)), [[vShow, _ctx.node.visible]]);\n}\n\nvar ElTreeNode = /* @__PURE__ */_export_sfc(_sfc_main, [[\"render\", _sfc_render], [\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/tree/src/tree-node.vue\"]]);\n\nexport { ElTreeNode as default };","map":{"version":3,"mappings":"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","names":["_sfc_main","defineComponent","name","components","ElCollapseTransition","ElCheckbox","NodeContent","ElIcon","Loading","props","node","type","default","accordion","renderContent","renderAfterExpand","showCheckbox","emits","setup","ctx","useNamespace","broadcastExpanded","useNodeExpandEventBroadcast","inject","ref","dragEventsKey","instance","getCurrentInstance","provide","tree","debugWarn","expanded","value","childNodeRendered","watch","data","childrenKey","children","updateChildren","indeterminate","val","handleSelectChange","checked","nextTick","getNodeKeyUtil","nodeKey","class","nodeClassFunc","className","oldChecked","oldIndeterminate","emit","e","store","currentNode","expandOnClickNode","handleExpandIconClick","checkOnClickNode","disabled","handleCheckChange","target","event","vnode","stopPropagation","preventDefault","isLeaf","collapse","expand","ev","setChecked","checkStrictly","checkedNodes","getCheckedNodes","checkedKeys","getCheckedKeys","halfCheckedNodes","getHalfCheckedNodes","halfCheckedKeys","getHalfCheckedKeys","handleChildNodeExpand","nodeData","instance2","draggable","dragEvents","treeNodeDragStart","treeNode","treeNodeDragOver","$el","node$","treeNodeDragEnd","ns","getNodeKey","getNodeClass","handleClick","handleContextMenu","handleDragStart","handleDragOver","handleDrop","handleDragEnd","CaretRight","_createElementBlock","_ctx","b","is","isCurrent","visible","role","tabindex","onClick","_cache","onContextmenu","onDragstart","onDragover","onDragend","onDrop","_createElementVNode","_normalizeClass","be","style","_normalizeStyle","paddingLeft","level","indent","icon","_openBlock","_createBlock","key","_withModifiers","onChange","_createCommentVNode","loading","openBlock","_createVNode","withDirectives","_Fragment","_renderList","childNodes","child","onNodeExpand"],"sources":["../../../../../../packages/components/tree/src/tree-node.vue"],"sourcesContent":["<template>\n  <div\n    v-show=\"node.visible\"\n    ref=\"node$\"\n    :class=\"[\n      ns.b('node'),\n      ns.is('expanded', expanded),\n      ns.is('current', node.isCurrent),\n      ns.is('hidden', !node.visible),\n      ns.is('focusable', !node.disabled),\n      ns.is('checked', !node.disabled && node.checked),\n      getNodeClass(node),\n    ]\"\n    role=\"treeitem\"\n    tabindex=\"-1\"\n    :aria-expanded=\"expanded\"\n    :aria-disabled=\"node.disabled\"\n    :aria-checked=\"node.checked\"\n    :draggable=\"tree.props.draggable\"\n    :data-key=\"getNodeKey(node)\"\n    @click.stop=\"handleClick\"\n    @contextmenu=\"handleContextMenu\"\n    @dragstart.stop=\"handleDragStart\"\n    @dragover.stop=\"handleDragOver\"\n    @dragend.stop=\"handleDragEnd\"\n    @drop.stop=\"handleDrop\"\n  >\n    <div\n      :class=\"ns.be('node', 'content')\"\n      :style=\"{ paddingLeft: (node.level - 1) * tree.props.indent + 'px' }\"\n    >\n      <el-icon\n        v-if=\"tree.props.icon || CaretRight\"\n        :class=\"[\n          ns.be('node', 'expand-icon'),\n          ns.is('leaf', node.isLeaf),\n          {\n            expanded: !node.isLeaf && expanded,\n          },\n        ]\"\n        @click.stop=\"handleExpandIconClick\"\n      >\n        <component :is=\"tree.props.icon || CaretRight\" />\n      </el-icon>\n      <el-checkbox\n        v-if=\"showCheckbox\"\n        :model-value=\"node.checked\"\n        :indeterminate=\"node.indeterminate\"\n        :disabled=\"!!node.disabled\"\n        @click.stop\n        @change=\"handleCheckChange\"\n      />\n      <el-icon\n        v-if=\"node.loading\"\n        :class=\"[ns.be('node', 'loading-icon'), ns.is('loading')]\"\n      >\n        <loading />\n      </el-icon>\n      <node-content :node=\"node\" :render-content=\"renderContent\" />\n    </div>\n    <el-collapse-transition>\n      <div\n        v-if=\"!renderAfterExpand || childNodeRendered\"\n        v-show=\"expanded\"\n        :class=\"ns.be('node', 'children')\"\n        role=\"group\"\n        :aria-expanded=\"expanded\"\n      >\n        <el-tree-node\n          v-for=\"child in node.childNodes\"\n          :key=\"getNodeKey(child)\"\n          :render-content=\"renderContent\"\n          :render-after-expand=\"renderAfterExpand\"\n          :show-checkbox=\"showCheckbox\"\n          :node=\"child\"\n          :accordion=\"accordion\"\n          :props=\"props\"\n          @node-expand=\"handleChildNodeExpand\"\n        />\n      </div>\n    </el-collapse-transition>\n  </div>\n</template>\n<script lang=\"ts\">\nimport {\n  defineComponent,\n  getCurrentInstance,\n  inject,\n  nextTick,\n  provide,\n  ref,\n  watch,\n} from 'vue'\nimport { isFunction, isString } from '@vue/shared'\nimport ElCollapseTransition from '@element-plus/components/collapse-transition'\nimport ElCheckbox from '@element-plus/components/checkbox'\nimport { ElIcon } from '@element-plus/components/icon'\nimport { CaretRight, Loading } from '@element-plus/icons-vue'\nimport { debugWarn } from '@element-plus/utils'\nimport { useNamespace } from '@element-plus/hooks'\nimport NodeContent from './tree-node-content.vue'\nimport { getNodeKey as getNodeKeyUtil } from './model/util'\nimport { useNodeExpandEventBroadcast } from './model/useNodeExpandEventBroadcast'\nimport { dragEventsKey } from './model/useDragNode'\nimport Node from './model/node'\n\nimport type { ComponentInternalInstance, PropType } from 'vue'\nimport type { Nullable } from '@element-plus/utils'\nimport type { RootTreeType, TreeNodeData, TreeOptionProps } from './tree.type'\n\nexport default defineComponent({\n  name: 'ElTreeNode',\n  components: {\n    ElCollapseTransition,\n    ElCheckbox,\n    NodeContent,\n    ElIcon,\n    Loading,\n  },\n  props: {\n    node: {\n      type: Node,\n      default: () => ({}),\n    },\n    props: {\n      type: Object as PropType<TreeOptionProps>,\n      default: () => ({}),\n    },\n    accordion: Boolean,\n    renderContent: Function,\n    renderAfterExpand: Boolean,\n    showCheckbox: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  emits: ['node-expand'],\n  setup(props, ctx) {\n    const ns = useNamespace('tree')\n    const { broadcastExpanded } = useNodeExpandEventBroadcast(props)\n    const tree = inject<RootTreeType>('RootTree')\n    const expanded = ref(false)\n    const childNodeRendered = ref(false)\n    const oldChecked = ref<boolean>(null)\n    const oldIndeterminate = ref<boolean>(null)\n    const node$ = ref<Nullable<HTMLElement>>(null)\n    const dragEvents = inject(dragEventsKey)\n    const instance = getCurrentInstance()\n\n    provide('NodeInstance', instance)\n    if (!tree) {\n      debugWarn('Tree', \"Can not find node's tree.\")\n    }\n\n    if (props.node.expanded) {\n      expanded.value = true\n      childNodeRendered.value = true\n    }\n\n    const childrenKey = tree.props['children'] || 'children'\n    watch(\n      () => {\n        const children = props.node.data[childrenKey]\n        return children && [...children]\n      },\n      () => {\n        props.node.updateChildren()\n      }\n    )\n\n    watch(\n      () => props.node.indeterminate,\n      (val) => {\n        handleSelectChange(props.node.checked, val)\n      }\n    )\n\n    watch(\n      () => props.node.checked,\n      (val) => {\n        handleSelectChange(val, props.node.indeterminate)\n      }\n    )\n\n    watch(\n      () => props.node.expanded,\n      (val) => {\n        nextTick(() => (expanded.value = val))\n        if (val) {\n          childNodeRendered.value = true\n        }\n      }\n    )\n\n    const getNodeKey = (node: Node): any => {\n      return getNodeKeyUtil(tree.props.nodeKey, node.data)\n    }\n\n    const getNodeClass = (node: Node) => {\n      const nodeClassFunc = props.props.class\n      if (!nodeClassFunc) {\n        return {}\n      }\n      let className\n      if (isFunction(nodeClassFunc)) {\n        const { data } = node\n        className = nodeClassFunc(data, node)\n      } else {\n        className = nodeClassFunc\n      }\n\n      if (isString(className)) {\n        return { [className]: true }\n      } else {\n        return className\n      }\n    }\n\n    const handleSelectChange = (checked: boolean, indeterminate: boolean) => {\n      if (\n        oldChecked.value !== checked ||\n        oldIndeterminate.value !== indeterminate\n      ) {\n        tree.ctx.emit('check-change', props.node.data, checked, indeterminate)\n      }\n      oldChecked.value = checked\n      oldIndeterminate.value = indeterminate\n    }\n\n    const handleClick = (e: MouseEvent) => {\n      const store = tree.store.value\n      store.setCurrentNode(props.node)\n      tree.ctx.emit(\n        'current-change',\n        store.currentNode ? store.currentNode.data : null,\n        store.currentNode\n      )\n      tree.currentNode.value = props.node\n\n      if (tree.props.expandOnClickNode) {\n        handleExpandIconClick()\n      }\n\n      if (tree.props.checkOnClickNode && !props.node.disabled) {\n        handleCheckChange(null, {\n          target: { checked: !props.node.checked },\n        })\n      }\n      tree.ctx.emit('node-click', props.node.data, props.node, instance, e)\n    }\n\n    const handleContextMenu = (event: Event) => {\n      if (tree.instance.vnode.props['onNodeContextmenu']) {\n        event.stopPropagation()\n        event.preventDefault()\n      }\n      tree.ctx.emit(\n        'node-contextmenu',\n        event,\n        props.node.data,\n        props.node,\n        instance\n      )\n    }\n\n    const handleExpandIconClick = () => {\n      if (props.node.isLeaf) return\n      if (expanded.value) {\n        tree.ctx.emit('node-collapse', props.node.data, props.node, instance)\n        props.node.collapse()\n      } else {\n        props.node.expand()\n        ctx.emit('node-expand', props.node.data, props.node, instance)\n      }\n    }\n\n    const handleCheckChange = (value, ev) => {\n      props.node.setChecked(ev.target.checked, !tree.props.checkStrictly)\n      nextTick(() => {\n        const store = tree.store.value\n        tree.ctx.emit('check', props.node.data, {\n          checkedNodes: store.getCheckedNodes(),\n          checkedKeys: store.getCheckedKeys(),\n          halfCheckedNodes: store.getHalfCheckedNodes(),\n          halfCheckedKeys: store.getHalfCheckedKeys(),\n        })\n      })\n    }\n\n    const handleChildNodeExpand = (\n      nodeData: TreeNodeData,\n      node: Node,\n      instance: ComponentInternalInstance\n    ) => {\n      broadcastExpanded(node)\n      tree.ctx.emit('node-expand', nodeData, node, instance)\n    }\n\n    const handleDragStart = (event: DragEvent) => {\n      if (!tree.props.draggable) return\n      dragEvents.treeNodeDragStart({ event, treeNode: props })\n    }\n\n    const handleDragOver = (event: DragEvent) => {\n      event.preventDefault()\n      if (!tree.props.draggable) return\n      dragEvents.treeNodeDragOver({\n        event,\n        treeNode: { $el: node$.value, node: props.node },\n      })\n    }\n\n    const handleDrop = (event: DragEvent) => {\n      event.preventDefault()\n    }\n\n    const handleDragEnd = (event: DragEvent) => {\n      if (!tree.props.draggable) return\n      dragEvents.treeNodeDragEnd(event)\n    }\n\n    return {\n      ns,\n      node$,\n      tree,\n      expanded,\n      childNodeRendered,\n      oldChecked,\n      oldIndeterminate,\n      getNodeKey,\n      getNodeClass,\n      handleSelectChange,\n      handleClick,\n      handleContextMenu,\n      handleExpandIconClick,\n      handleCheckChange,\n      handleChildNodeExpand,\n      handleDragStart,\n      handleDragOver,\n      handleDrop,\n      handleDragEnd,\n      CaretRight,\n    }\n  },\n})\n</script>\n"]},"metadata":{},"sourceType":"module"}