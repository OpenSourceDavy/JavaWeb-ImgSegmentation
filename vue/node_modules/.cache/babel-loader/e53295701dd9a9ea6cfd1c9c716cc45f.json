{"ast":null,"code":"import request from \"@/utils/request\";\nimport Register from \"./Register.vue\";\nexport default {\n  name: \"Login\",\n  components: {\n    Register\n  },\n\n  data() {\n    return {\n      specialist: [],\n      patient: [],\n      form: {},\n      rulesLogin: {\n        username: [{\n          required: true,\n          message: 'please input username',\n          trigger: 'blur'\n        }],\n        password: [{\n          required: true,\n          message: 'please input password',\n          trigger: 'blur'\n        }],\n        role: [{\n          required: true,\n          message: 'please select usertype',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n\n  created() {\n    sessionStorage.removeItem(\"user\");\n    this.get();\n  },\n\n  methods: {\n    login() {\n      this.$refs['formLogin'].validate(valid => {\n        if (valid) {\n          let url = \"\";\n          let path = \"\";\n\n          if (this.form.role === '0') {\n            //管理员登录\n            url = \"/root/login\";\n            path = \"/patient\";\n          } else if (this.form.role === '1') {\n            //病人登录\n            url = \"/user/patient/login\";\n            path = \"/img\";\n          } else {\n            //专家登录\n            url = \"/user/specialist/login\";\n            path = \"/img\";\n          }\n\n          request.post(url, this.form).then(res => {\n            if (res.code === '0') {\n              this.$message({\n                type: \"success\",\n                message: \"login success\"\n              });\n              sessionStorage.setItem(\"user\", JSON.stringify(res.data));\n              this.$router.push(path); //登陆成功后进行页面跳转，跳转到主页\n            } else {\n              this.$message({\n                type: \"error\",\n                message: res.msg\n              });\n            }\n          });\n        }\n      });\n    },\n\n    get() {\n      // request.get(\"/specialist/get\",{\n      // }).then(res => {\n      //   this.specialist = res\n      //   sessionStorage.setItem(\"specialist\",JSON.stringify(res))\n      // })\n      // request.get(\"/patient/get\",{\n      // }).then(res => {\n      //   this.patient = res\n      //   sessionStorage.setItem(\"patient\",JSON.stringify(res))\n      // })\n      request.get(\"/user/get\", {\n        params: {\n          role: 1\n        }\n      }).then(res => {\n        this.patient = res;\n        console.log(res);\n        sessionStorage.setItem(\"patient\", JSON.stringify(res));\n      });\n      request.get(\"/user/get\", {\n        params: {\n          role: 2\n        }\n      }).then(res => {\n        this.specialist = res;\n        console.log(res);\n        sessionStorage.setItem(\"specialist\", JSON.stringify(res));\n      });\n    },\n\n    register() {\n      this.$refs.register.init();\n      this.form = {};\n    }\n\n  }\n};","map":{"version":3,"mappings":"AA2CA,OAAOA,OAAP,MAAoB,iBAApB;AACA,OAAOC,QAAP,MAAqB,gBAArB;AAEA,eAAe;AACbC,MAAI,EAAE,OADO;AAEbC,YAAU,EAAE;AACVF;AADU,GAFC;;AAKbG,MAAI,GAAE;AACJ,WAAO;AACLC,gBAAU,EAAC,EADN;AAELC,aAAO,EAAC,EAFH;AAGLC,UAAI,EAAC,EAHA;AAILC,gBAAU,EAAE;AACVC,gBAAQ,EAAE,CACR;AAAEC,kBAAQ,EAAE,IAAZ;AAAkBC,iBAAO,EAAE,uBAA3B;AAAoDC,iBAAO,EAAE;AAA7D,SADQ,CADA;AAIVC,gBAAQ,EAAE,CACR;AAAEH,kBAAQ,EAAE,IAAZ;AAAkBC,iBAAO,EAAE,uBAA3B;AAAoDC,iBAAO,EAAE;AAA7D,SADQ,CAJA;AAOVE,YAAI,EAAE,CACJ;AAAEJ,kBAAQ,EAAE,IAAZ;AAAkBC,iBAAO,EAAE,wBAA3B;AAAqDC,iBAAO,EAAE;AAA9D,SADI;AAPI;AAJP,KAAP;AAgBD,GAtBY;;AAuBbG,SAAO,GAAG;AACRC,kBAAc,CAACC,UAAf,CAA0B,MAA1B;AACA,SAAKC,GAAL;AACD,GA1BY;;AA2BbC,SAAO,EAAC;AACNC,SAAK,GAAE;AACL,WAAKC,KAAL,CAAW,WAAX,EAAwBC,QAAxB,CAAkCC,KAAD,IAAW;AAC1C,YAAIA,KAAJ,EAAW;AACT,cAAIC,GAAE,GAAI,EAAV;AACA,cAAIC,IAAG,GAAI,EAAX;;AACA,cAAG,KAAKlB,IAAL,CAAUO,IAAV,KAAmB,GAAtB,EAA0B;AACxB;AACAU,eAAE,GAAI,aAAN;AACAC,gBAAG,GAAI,UAAP;AACD,WAJD,MAIM,IAAG,KAAKlB,IAAL,CAAUO,IAAV,KAAmB,GAAtB,EAA0B;AAC9B;AACAU,eAAE,GAAI,qBAAN;AACAC,gBAAG,GAAI,MAAP;AACD,WAJK,MAID;AACH;AACAD,eAAE,GAAI,wBAAN;AACAC,gBAAG,GAAI,MAAP;AACF;;AACAzB,iBAAO,CAAC0B,IAAR,CAAaF,GAAb,EAAiB,KAAKjB,IAAtB,EAA4BoB,IAA5B,CAAiCC,GAAE,IAAK;AACtC,gBAAIA,GAAG,CAACC,IAAJ,KAAa,GAAjB,EAAsB;AACpB,mBAAKC,QAAL,CAAc;AACZC,oBAAI,EAAE,SADM;AAEZpB,uBAAO,EAAE;AAFG,eAAd;AAKAK,4BAAc,CAACgB,OAAf,CAAuB,MAAvB,EAA8BC,IAAI,CAACC,SAAL,CAAeN,GAAG,CAACxB,IAAnB,CAA9B;AAEA,mBAAK+B,OAAL,CAAaC,IAAb,CAAkBX,IAAlB,EARoB,CAQK;AAC3B,aATA,MASO;AACL,mBAAKK,QAAL,CAAc;AACZC,oBAAI,EAAE,OADM;AAEZpB,uBAAO,EAAEiB,GAAG,CAACS;AAFD,eAAd;AAIF;AACD,WAhBD;AAiBF;AACD,OAnCD;AAoCD,KAtCK;;AAwCNnB,OAAG,GAAE;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAlB,aAAO,CAACkB,GAAR,CAAY,WAAZ,EAAwB;AACtBoB,cAAM,EAAC;AACLxB,cAAI,EAAC;AADA;AADe,OAAxB,EAIGa,IAJH,CAIQC,GAAE,IAAK;AACb,aAAKtB,OAAL,GAAesB,GAAf;AACAW,eAAO,CAACC,GAAR,CAAYZ,GAAZ;AACAZ,sBAAc,CAACgB,OAAf,CAAuB,SAAvB,EAAiCC,IAAI,CAACC,SAAL,CAAeN,GAAf,CAAjC;AACD,OARD;AASA5B,aAAO,CAACkB,GAAR,CAAY,WAAZ,EAAwB;AACtBoB,cAAM,EAAC;AACLxB,cAAI,EAAC;AADA;AADe,OAAxB,EAIGa,IAJH,CAIQC,GAAE,IAAK;AACb,aAAKvB,UAAL,GAAkBuB,GAAlB;AACAW,eAAO,CAACC,GAAR,CAAYZ,GAAZ;AACAZ,sBAAc,CAACgB,OAAf,CAAuB,YAAvB,EAAoCC,IAAI,CAACC,SAAL,CAAeN,GAAf,CAApC;AACD,OARD;AASD,KArEK;;AAwENa,YAAQ,GAAE;AACR,WAAKpB,KAAL,CAAWoB,QAAX,CAAoBC,IAApB;AACA,WAAKnC,IAAL,GAAY,EAAZ;AACD;;AA3EK;AA3BK,CAAf","names":["request","Register","name","components","data","specialist","patient","form","rulesLogin","username","required","message","trigger","password","role","created","sessionStorage","removeItem","get","methods","login","$refs","validate","valid","url","path","post","then","res","code","$message","type","setItem","JSON","stringify","$router","push","msg","params","console","log","register","init"],"sourceRoot":"","sources":["C:\\Users\\davy3\\crm_vue1\\vue\\src\\views\\Login.vue"],"sourcesContent":["<template>\r\n  <div style=\"width: 100%; height: 100vh; background-color: darkgreen; overflow:hidden\">\r\n    <div style=\"width: 400px; margin: 150px auto\">\r\n      <div style=\"color: #cccccc; font-size: 30px; text-align: center; padding:30px 0 \">Blood Vessel Diagnose Cloud Platform</div>\r\n      <el-form ref=\"formLogin\" :model=\"form\" size=\"normal\" :rules=\"rulesLogin\">\r\n        <el-form-item prop=\"username\">\r\n          <el-input v-model=\"form.username\" placeholder=\"username\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item prop=\"password\">\r\n          <el-input v-model=\"form.password\" placeholder=\"password\" show-password></el-input>\r\n        </el-form-item>\r\n        <el-form-item prop=\"role\">\r\n          <el-radio v-model=\"form.role\" label=\"0\" style=\"width: 31%\">\r\n            <span style=\"color:#cccccc;\">\r\n              admin\r\n            </span>\r\n          </el-radio>\r\n          <el-radio v-model=\"form.role\" label=\"1\" style=\"width: 31%\">\r\n            <span style=\"color:#cccccc;\">\r\n              patient\r\n            </span>\r\n          </el-radio>\r\n          <el-radio v-model=\"form.role\" label=\"2\">\r\n            <span style=\"color:#cccccc;\">\r\n              specialist\r\n            </span>\r\n          </el-radio>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button style = \"width:100%\" type=\"primary\" @click=\"login\">login</el-button>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button style = \"width:100%\" type=\"primary\" @click=\"register\">register</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n\r\n\r\n  <register ref=\"register\" ></register>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport request from \"@/utils/request\";\r\nimport Register from \"./Register.vue\";\r\n\r\nexport default {\r\n  name: \"Login\",\r\n  components: {\r\n    Register,\r\n  },\r\n  data(){\r\n    return {\r\n      specialist:[],\r\n      patient:[],\r\n      form:{},\r\n      rulesLogin: {\r\n        username: [\r\n          { required: true, message: 'please input username', trigger: 'blur'},\r\n        ],\r\n        password: [\r\n          { required: true, message: 'please input password', trigger: 'blur'},\r\n        ],\r\n        role: [\r\n          { required: true, message: 'please select usertype', trigger: 'blur'},\r\n        ],\r\n      },\r\n    }\r\n  },\r\n  created() {\r\n    sessionStorage.removeItem(\"user\")\r\n    this.get()\r\n  },\r\n  methods:{\r\n    login(){\r\n      this.$refs['formLogin'].validate((valid) => {\r\n        if (valid) {\r\n          let url = \"\"\r\n          let path = \"\"\r\n          if(this.form.role === '0'){\r\n            //管理员登录\r\n            url = \"/root/login\"\r\n            path = \"/patient\"\r\n          }else if(this.form.role === '1'){\r\n            //病人登录\r\n            url = \"/user/patient/login\"\r\n            path = \"/img\"\r\n          }else{\r\n            //专家登录\r\n            url = \"/user/specialist/login\"\r\n            path = \"/img\"\r\n          }\r\n          request.post(url,this.form).then(res => {\r\n            if (res.code === '0') {\r\n              this.$message({\r\n                type: \"success\",\r\n                message: \"login success\"\r\n              })\r\n\r\n              sessionStorage.setItem(\"user\",JSON.stringify(res.data))\r\n\r\n              this.$router.push(path)  //登陆成功后进行页面跳转，跳转到主页\r\n            } else {\r\n              this.$message({\r\n                type: \"error\",\r\n                message: res.msg\r\n              })\r\n            }\r\n          })\r\n        }\r\n      })\r\n    },\r\n\r\n    get(){\r\n      // request.get(\"/specialist/get\",{\r\n      // }).then(res => {\r\n      //   this.specialist = res\r\n      //   sessionStorage.setItem(\"specialist\",JSON.stringify(res))\r\n      // })\r\n      // request.get(\"/patient/get\",{\r\n      // }).then(res => {\r\n      //   this.patient = res\r\n      //   sessionStorage.setItem(\"patient\",JSON.stringify(res))\r\n      // })\r\n      request.get(\"/user/get\",{\r\n        params:{\r\n          role:1\r\n        }\r\n      }).then(res => {\r\n        this.patient = res\r\n        console.log(res)\r\n        sessionStorage.setItem(\"patient\",JSON.stringify(res))\r\n      })\r\n      request.get(\"/user/get\",{\r\n        params:{\r\n          role:2\r\n        }\r\n      }).then(res => {\r\n        this.specialist = res\r\n        console.log(res)\r\n        sessionStorage.setItem(\"specialist\",JSON.stringify(res))\r\n      })\r\n    },\r\n\r\n\r\n    register(){\r\n      this.$refs.register.init();\r\n      this.form = {}\r\n    },\r\n\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}